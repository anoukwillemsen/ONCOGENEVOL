data <- read.table("table_no-realignment_treelen_lnl_100iter.txt", header=T);
tlen_H0 <- data$treelen_ALL;
tlen_H1 <- data$treelen_gray + data$treelen_part_H1;
tlen_H2 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H2;
tlen_H3 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_part_H3;
tlen_H4 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_part_H4;
tlen_H5 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H5_1 + data$treelen_part_H5_2;
tlen_H6 <- data$treelen_gray + data$treelen_blue + data$treelen_red + data$treelen_black + data$treelen_part_H5_2;
tlen_H7 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_black + data$treelen_green;
treelen <- cbind(tlen_H0, tlen_H1, tlen_H2, tlen_H3, tlen_H4, tlen_H5, tlen_H6, tlen_H7);
lnl_H0 <- data$lnl_ALL;
lnl_H1 <- data$lnl_gray + data$lnl_part_H1;
lnl_H2 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H2;
lnl_H3 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3;
lnl_H4 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4;
lnl_H5 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2;
lnl_H6 <- data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2;
lnl_H7 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green;
loglik <- cbind(lnl_H0, lnl_H1, lnl_H2, lnl_H3, lnl_H4, lnl_H5, lnl_H6, lnl_H7);
bf_H0 <- (data$lnl_ALL) - (data$lnl_ALL);
bf_H1 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_part_H1);
bf_H2 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H2);
bf_H3 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3);
bf_H4 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4);
bf_H5 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2);
bf_H6 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2);
bf_H7 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green);
bayes <- cbind(bf_H0, bf_H1, bf_H2, bf_H3, bf_H4, bf_H5, bf_H6, bf_H7);
treelen_melt <- melt(treelen);
class(treelen_melt$Var2);
ggplot(treelen_melt, aes(x=value, fill=Var2), xlim=c(0,45)) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
leveneTest(treelen_melt$value ~ treelen_melt$Var2);
maov <- aov(treelen_melt$value ~ treelen_melt$Var2);
summary(maov);
TukeyHSD(maov);
loglik_melt <- melt(loglik);
class(loglik_melt$Var2);
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E6");
bayes_melt <- melt(bayes);
class(bayes_melt$Var2);
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E6");
setwd("/DATA/work/ONCOGENEVOL/database/trees/Bali-Phy/RD1_E6_permutations/test_randomly_shuffled_data");
library(reshape2);
library(ggplot2);
library(car);
data <- read.table("table_treelen_lnl_100iter.txt", header=T);
tlen_H0 <- data$treelen_ALL;
tlen_H1 <- data$treelen_gray + data$treelen_part_H1;
tlen_H2 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H2;
tlen_H3 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_part_H3;
tlen_H4 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_part_H4;
tlen_H5 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H5_1 + data$treelen_part_H5_2;
tlen_H6 <- data$treelen_gray + data$treelen_blue + data$treelen_red + data$treelen_black + data$treelen_part_H5_2;
tlen_H7 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_black + data$treelen_green;
treelen <- cbind(tlen_H0, tlen_H1, tlen_H2, tlen_H3, tlen_H4, tlen_H5, tlen_H6, tlen_H7);
lnl_H0 <- data$lnl_ALL;
lnl_H1 <- data$lnl_gray + data$lnl_part_H1;
lnl_H2 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H2;
lnl_H3 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3;
lnl_H4 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4;
lnl_H5 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2;
lnl_H6 <- data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2;
lnl_H7 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green;
loglik <- cbind(lnl_H0, lnl_H1, lnl_H2, lnl_H3, lnl_H4, lnl_H5, lnl_H6, lnl_H7);
bf_H0 <- (data$lnl_ALL) - (data$lnl_ALL);
bf_H1 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_part_H1);
bf_H2 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H2);
bf_H3 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3);
bf_H4 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4);
bf_H5 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2);
bf_H6 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2);
bf_H7 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green);
bayes <- cbind(bf_H0, bf_H1, bf_H2, bf_H3, bf_H4, bf_H5, bf_H6, bf_H7);
treelen_melt <- melt(treelen);
class(treelen_melt$Var2);
ggplot(treelen_melt, aes(x=value, fill=Var2), xlim=c(0,45)) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
dev.off();
loglik_melt <- melt(loglik);
class(loglik_melt$Var2);
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E6");
dev.off();
g
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E6");
dev.off();
bayes_melt <- melt(bayes);
class(bayes_melt$Var2);
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E6");
dev.off();
leveneTest(treelen_melt$value ~ treelen_melt$Var2);
leveneTest(treelen_melt$value ~ treelen_melt$Var2, center="mean");
oneway.test(treelen_melt$value ~ treelen_melt$Var2);
shapiro.test(treelen_melt$value ~ treelen_melt$Var2)
shapiro.test
?shapiro.test
shapiro.test(tlen_H0);
?kruskal.test
kruskal.test(tlen_H0, tlen_H1);
kruskal.test(tlen_H0, tlen_H1);
kruskal.test(tlen_H0, tlen_H2);
kruskal.test(tlen_H0, tlen_H3);
kruskal.test(tlen_H0, tlen_H4);
kruskal.test(tlen_H0, tlen_H5);
kruskal.test(tlen_H0, tlen_H6);
kruskal.test(tlen_H0, tlen_H7);
wilcox.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H7);
?wilcox.test
wilcox.test(tlen_H0, tlen_H1, paired = T);
kruskal.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H1, paired = F);
wilcox.test(tlen_H0, tlen_H1, alternative = "less");
wilcox.test(tlen_H0, tlen_H7, alternative = "less");
wilcox.test(tlen_H0, tlen_H7, paired=T, alternative = "less");
wilcox.test(tlen_H0, tlen_H7, alternative = "greater");
wilcox.test(tlen_H0, tlen_H7, exact=T);
wilcox.test(32.31090379, tlen_H1, alternative = "less");
wilcox.test(32.31090379, tlen_H0, alternative = "less");
wilcox.test(32.31090379, tlen_H0);
wilcox.test(32.31090379, tlen_H1, alternative = "greater");
kruskal.test(tlen_H0, tlen_H1);
kruskal.test(tlen_H0, tlen_H2);
kruskalmc(treelen_melt$value ~ treelen_melt$Var2);
library(pgirmess);
kruskalmc(treelen_melt$value ~ treelen_melt$Var2);
ggplot(treelen_melt, aes(x=value, fill=Var2), xlim=c(0,45)) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
?kruskalmc
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="one-tailed");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
ggplot(treelen_melt, aes(x=value, fill=Var2), xlim=c(0,45)) +
geom_density() +
xlab("ML tree length") +
ggtitle("RD1: E6");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
wilcox.test(treelen_melt$value ~ treelen_melt$Var2);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H1);
kruskal.test(tlen_H0, tlen_H1);
?kruskal.test
?wilcox.test
wilcox.test(tlen_H0, tlen_H1, alternative="less");
wilcox.test(tlen_H0, tlen_H1);
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2);
?kruskalmc
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="one-tailed");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
hist(tlen_H0)
x1 <- hist(tlen_H0);
x2 <- hist(tlen_H1);
x1
plot(x1$mids, x1$counts, type="h", col = "blue",xlab="ML tree length", ylab="frequency");
lines(x2$mids, x2$counts, type="h", col = "red");
ymax <- max(x1$counts, x2$counts);
max(x1$counts, x2$counts);
x1
x2
plot  (x1$mids, x1$counts, type="h", col = "blue", ylim=c(0,ymax),xlab="ML tree length", ylab="frequency");
lines (x2$mids, x2$counts, type="h", col = "red");
legend ("top", cex = 0.8, legend = c("before realignment", "after realignment"), bty = "n", text.col = c("blue", "red"));
plot(x1$mids, x1$counts, type="h", col = "blue", ylim=c(0,ymax),xlab="ML tree length", ylab="frequency");
lines(x2$mids, x2$counts, type="h", col = "red");
x0 <- hist(tlen_H0);
x1 <- hist(tlen_H1);
x2 <- hist(tlen_H2);
x3 <- hist(tlen_H3);
x4 <- hist(tlen_H4);
x5 <- hist(tlen_H5);
x6 <- hist(tlen_H6);
x7 <- hist(tlen_H7);
palette
palette()
?ggplot
x0 <- hist(tlen_H0);
x1 <- hist(tlen_H1);
x2 <- hist(tlen_H2);
x3 <- hist(tlen_H3);
x4 <- hist(tlen_H4);
x5 <- hist(tlen_H5);
x6 <- hist(tlen_H6);
x7 <- hist(tlen_H7);
ymax <- max(x0$counts, x1$counts, x2$counts, x3$counts, x4$counts, x5$counts, x6$counts, x7$counts);
lines(x2$mids, x2$counts, type="h", col = "red");
plot(x0$mids, x0$counts, type="h", col = "blue", ylim=c(0,ymax),xlab="ML tree length", ylab="frequency");
lines(x1$mids, x1$counts, type="h", col = "red");
lines(x2$mids, x2$counts, type="h", col = "red");
lines(x3$mids, x3$counts, type="h", col = "red");
lines(x4$mids, x4$counts, type="h", col = "red");
lines(x5$mids, x5$counts, type="h", col = "red");
lines(x6$mids, x6$counts, type="h", col = "red");
lines(x7$mids, x7$counts, type="h", col = "red");
legend ("top", cex = 0.8, legend = c("before realignment", "after realignment"), bty = "n", text.col = c("blue", "red"));
x0
hist(tlen_H0);
plot(x0$mids, x0$counts, type="h", col = "blue", ylim=c(0,ymax),xlab="ML tree length", ylab="frequency");
plot(x0$mids, x0$counts, type="h", col = "blue", ylim=c(0,ymax), xlim=c(0,),xlab="ML tree length", ylab="frequency");
plot(x0$mids, x0$counts, type="h", col = "blue", ylim=c(0,ymax), xlim=c(0,ymax),xlab="ML tree length", ylab="frequency");
lines(x1$mids, x1$counts, type="h", col = "red");
lines(x2$mids, x2$counts, type="h", col = "red");
lines(x3$mids, x3$counts, type="h", col = "red");
lines(x4$mids, x4$counts, type="h", col = "red");
lines(x5$mids, x5$counts, type="h", col = "red");
lines(x6$mids, x6$counts, type="h", col = "red");
lines(x7$mids, x7$counts, type="h", col = "red");
legend ("top", cex = 0.8, legend = c("before realignment", "after realignment"), bty = "n", text.col = c("blue", "red"));
wilcox.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H7);
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
wilcox.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H7);
quit();
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
ggplot(treelen_melt, aes(x=value, fill=Var2), xlim=c(0,45)) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
ggplot(treelen_melt, aes(x=value, fill=Var2)) +
xlim(20,40) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
ggplot(treelen_melt, aes(x=value, fill=Var2)) +
xlim(25,40) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
ggplot(treelen_melt, aes(x=value, fill=Var2)) +
#  xlim(25,40) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
loglik_melt <- melt(loglik);
class(loglik_melt$Var2);
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E6");
dev.off();
bayes_melt <- melt(bayes);
class(bayes_melt$Var2);
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E6");
dev.off();
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E6");
setwd("/DATA/work/ONCOGENEVOL/database/trees/Bali-Phy/RD1_E6_permutations/test_randomly_shuffled_data");
library(reshape2); #to melt data
library(ggplot2); #for plotting
library(pgirmess); #for kruskalmc
data <- read.table("table_treelen_lnl_100iter.txt", header=T);
tlen_H0 <- data$treelen_ALL;
tlen_H1 <- data$treelen_gray + data$treelen_part_H1;
tlen_H2 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H2;
tlen_H3 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_part_H3;
tlen_H4 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_part_H4;
tlen_H5 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H5_1 + data$treelen_part_H5_2;
tlen_H6 <- data$treelen_gray + data$treelen_blue + data$treelen_red + data$treelen_black + data$treelen_part_H5_2;
tlen_H7 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_black + data$treelen_green;
treelen <- cbind(tlen_H0, tlen_H1, tlen_H2, tlen_H3, tlen_H4, tlen_H5, tlen_H6, tlen_H7);
lnl_H0 <- data$lnl_ALL;
lnl_H1 <- data$lnl_gray + data$lnl_part_H1;
lnl_H2 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H2;
lnl_H3 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3;
lnl_H4 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4;
lnl_H5 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2;
lnl_H6 <- data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2;
lnl_H7 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green;
loglik <- cbind(lnl_H0, lnl_H1, lnl_H2, lnl_H3, lnl_H4, lnl_H5, lnl_H6, lnl_H7);
bf_H0 <- (data$lnl_ALL) - (data$lnl_ALL);
bf_H1 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_part_H1);
bf_H2 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H2);
bf_H3 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3);
bf_H4 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4);
bf_H5 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2);
bf_H6 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2);
bf_H7 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green);
bayes <- cbind(bf_H0, bf_H1, bf_H2, bf_H3, bf_H4, bf_H5, bf_H6, bf_H7);
setwd("/DATA/work/ONCOGENEVOL/database/trees/Bali-Phy/RD1_E6_permutations/test_randomly_shuffled_data");
library(reshape2); #to melt data
library(ggplot2); #for plotting
library(pgirmess); #for kruskalmc
data <- read.table("table_treelen_lnl_100iter.txt", header=T);
tlen_H0 <- data$treelen_ALL;
tlen_H1 <- data$treelen_gray + data$treelen_part_H1;
tlen_H2 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H2;
tlen_H3 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_part_H3;
tlen_H4 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_part_H4;
tlen_H5 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H5_1 + data$treelen_part_H5_2;
tlen_H6 <- data$treelen_gray + data$treelen_blue + data$treelen_red + data$treelen_black + data$treelen_part_H5_2;
tlen_H7 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_black + data$treelen_green;
treelen <- cbind(tlen_H0, tlen_H1, tlen_H2, tlen_H3, tlen_H4, tlen_H5, tlen_H6, tlen_H7);
lnl_H0 <- data$lnl_ALL;
lnl_H1 <- data$lnl_gray + data$lnl_part_H1;
lnl_H2 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H2;
lnl_H3 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3;
lnl_H4 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4;
lnl_H5 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2;
lnl_H6 <- data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2;
lnl_H7 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green;
loglik <- cbind(lnl_H0, lnl_H1, lnl_H2, lnl_H3, lnl_H4, lnl_H5, lnl_H6, lnl_H7);
bf_H0 <- (data$lnl_ALL) - (data$lnl_ALL);
bf_H1 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_part_H1);
bf_H2 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H2);
bf_H3 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3);
bf_H4 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4);
bf_H5 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2);
bf_H6 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2);
bf_H7 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green);
bayes <- cbind(bf_H0, bf_H1, bf_H2, bf_H3, bf_H4, bf_H5, bf_H6, bf_H7);
treelen_melt <- melt(treelen);
class(treelen_melt$Var2);
ggplot(treelen_melt, aes(x=value, fill=Var2)) +
#  xlim(25,40) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6");
dev.off();
loglik_melt <- melt(loglik);
class(loglik_melt$Var2);
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E6");
bayes_melt <- melt(bayes);
class(bayes_melt$Var2);
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E6");
kruskalmc(treelen_melt$value ~ treelen_melt$Var2, cont="two-tailed");
wilcox.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H7);
quit();
setwd("/DATA/work/ONCOGENEVOL/database/trees/Bali-Phy/RD1_E7_permutations/test_randomly_shuffled_data");
library(reshape2); #to melt data
library(ggplot2); #for plotting
library(pgirmess); #for kruskalmc
data <- read.table("table_treelen_lnl_100iter.txt", header=T);
tlen_H0 <- data$treelen_ALL;
tlen_H1 <- data$treelen_gray + data$treelen_part_H1;
tlen_H2 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H2;
tlen_H3 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_part_H3;
tlen_H4 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_part_H4;
tlen_H5 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H5_1 + data$treelen_part_H5_2;
tlen_H6 <- data$treelen_gray + data$treelen_blue + data$treelen_red + data$treelen_black + data$treelen_part_H5_2;
tlen_H7 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_black + data$treelen_green;
treelen <- cbind(tlen_H0, tlen_H1, tlen_H2, tlen_H3, tlen_H4, tlen_H5, tlen_H6, tlen_H7);
lnl_H0 <- data$lnl_ALL;
lnl_H1 <- data$lnl_gray + data$lnl_part_H1;
lnl_H2 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H2;
lnl_H3 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3;
lnl_H4 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4;
lnl_H5 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2;
lnl_H6 <- data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2;
lnl_H7 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green;
loglik <- cbind(lnl_H0, lnl_H1, lnl_H2, lnl_H3, lnl_H4, lnl_H5, lnl_H6, lnl_H7);
bf_H0 <- (data$lnl_ALL) - (data$lnl_ALL);
bf_H1 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_part_H1);
bf_H2 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H2);
bf_H3 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3);
bf_H4 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4);
bf_H5 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2);
bf_H6 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2);
bf_H7 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green);
bayes <- cbind(bf_H0, bf_H1, bf_H2, bf_H3, bf_H4, bf_H5, bf_H6, bf_H7);
treelen_melt <- melt(treelen);
class(treelen_melt$Var2);
#svg(file="hist_MLtreelen_100iter.svg");
ggplot(treelen_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E7");
dev.off();
loglik_melt <- melt(loglik);
class(loglik_melt$Var2);
#svg(file="hist_LnL_100iter.svg");
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E7");
dev.off();
bayes_melt <- melt(bayes);
class(bayes_melt$Var2);
#svg(file="hist_BF_100iter.svg");
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E7");
dev.off();
kruskal.test(treelen_melt$value ~ treelen_melt$Var2);
kruskalmc(treelen_melt$value ~ treelen_melt$Var2);
wilcox.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H7);
setwd("/DATA/work/ONCOGENEVOL/database/trees/Bali-Phy/RD1_E6E7_permutations/test_randomly_shuffled_data");
library(reshape2);
library(ggplot2);
data <- read.table("table_treelen_lnl_100iter.txt", header=T);
tlen_H0 <- data$treelen_ALL;
tlen_H1 <- data$treelen_gray + data$treelen_part_H1;
tlen_H2 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H2;
tlen_H3 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_part_H3;
tlen_H4 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_part_H4;
tlen_H5 <- data$treelen_gray + data$treelen_blue + data$treelen_part_H5_1 + data$treelen_part_H5_2;
tlen_H6 <- data$treelen_gray + data$treelen_blue + data$treelen_red + data$treelen_black + data$treelen_part_H5_2;
tlen_H7 <- data$treelen_gray + data$treelen_blue + data$treelen_yellow + data$treelen_red + data$treelen_black + data$treelen_green;
treelen <- cbind(tlen_H0, tlen_H1, tlen_H2, tlen_H3, tlen_H4, tlen_H5, tlen_H6, tlen_H7);
lnl_H0 <- data$lnl_ALL;
lnl_H1 <- data$lnl_gray + data$lnl_part_H1;
lnl_H2 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H2;
lnl_H3 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3;
lnl_H4 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4;
lnl_H5 <- data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2;
lnl_H6 <- data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2;
lnl_H7 <- data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green;
loglik <- cbind(lnl_H0, lnl_H1, lnl_H2, lnl_H3, lnl_H4, lnl_H5, lnl_H6, lnl_H7);
bf_H0 <- (data$lnl_ALL) - (data$lnl_ALL);
bf_H1 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_part_H1);
bf_H2 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H2);
bf_H3 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_part_H3);
bf_H4 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_part_H4);
bf_H5 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_part_H5_1 + data$lnl_part_H5_2);
bf_H6 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_red + data$lnl_black + data$lnl_part_H5_2);
bf_H7 <- (data$lnl_ALL) - (data$lnl_gray + data$lnl_blue + data$lnl_yellow + data$lnl_red + data$lnl_black + data$lnl_green);
bayes <- cbind(bf_H0, bf_H1, bf_H2, bf_H3, bf_H4, bf_H5, bf_H6, bf_H7);
treelen_melt <- melt(treelen);
class(treelen_melt$Var2);
#svg(file="hist_MLtreelen_100iter.svg");
ggplot(treelen_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=60) +
xlab("ML tree length") +
ggtitle("RD1: E6E7");
dev.off();
loglik_melt <- melt(loglik);
class(loglik_melt$Var2);
ggplot(loglik_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Log likelihood") +
ggtitle("RD1: E6E7");
dev.off();
bayes_melt <- melt(bayes);
class(bayes_melt$Var2);
ggplot(bayes_melt, aes(x=value, fill=Var2)) +
geom_histogram(bins=30) +
xlab("Bayes Factor") +
ggtitle("RD1: E6E7");
dev.off();
kruskalmc(treelen_melt$value ~ treelen_melt$Var2);
wilcox.test(tlen_H0, tlen_H1);
wilcox.test(tlen_H0, tlen_H2);
wilcox.test(tlen_H0, tlen_H3);
wilcox.test(tlen_H0, tlen_H4);
wilcox.test(tlen_H0, tlen_H5);
wilcox.test(tlen_H0, tlen_H6);
wilcox.test(tlen_H0, tlen_H7);
